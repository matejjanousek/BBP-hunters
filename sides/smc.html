<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="../styles/sidestyle.css">
    <title>Broken Access Control | OWASP #1 Analysis</title>
</head>
<body>
    <div class="overlay"></div>
    
    <header class="main-header">
        <a href="web_security.html" class="header-link">
            <h1>[ SECURITY_MISCONFIGURATION ]</h1>
            <p>Kliknutím se vrátíš zpět.</p>
        </a>
    </header>

    <main class="detail-container">
        <section class="content-section">
            <h2>Chyba v nastavení, ne v kódu</h2>
            <p><strong>Security Misconfiguration</strong> vzniká tam, kde končí vývoj a začíná správa. Je to důsledek neúplného hardeningu, ponechání defaultních hodnot nebo přílišné upovídanosti systému. V éře cloudu a kontejnerizace se toto riziko multiplikuje.</p>
            
            <div class="knowledge-box">
                <h3>Kritické vektory útoku:</h3>
                <ul>
                    <li><strong>Default Credentials:</strong> Ponechání hesel jako <code>admin/password</code> v systémech jako Jenkins, Grafana nebo Docker registry.</li>
                    <li><strong>Verbose Error Messages:</strong> Únik stack trace, který odhaluje verze frameworků, cesty k souborům (<code>/var/www/html/...</code>) a vnitřní logiku.</li>
                    <li><strong>Unnecessary Features:</strong> Otevřené porty, zapnutý <code>WebDAV</code>, nebo testovací skripty (<code>test.php</code>, <code>info.php</code>) v produkci.</li>
                </ul>
            </div>
        </section>

        

        <section class="content-section">
            <h2>Moderní hrozba: Cloud & S3 Buckety</h2>
            <p>V Bug Bounty je hledání špatně nastavených cloudových úložišť (AWS S3, Azure Blobs) disciplínou samo o sobě. Jediný chybný klik v nastavení ACL (Access Control List) může zpřístupnit gigabajty citlivých dat celému světu.</p>
            <div class="grid">
                <div class="status-box">
                    <span class="code">Public Buckets</span>
                    <p>Úložiště nastavená jako "Public Listable". Kdokoliv může stáhnout databáze, zdrojáky nebo osobní údaje zákazníků.</p>
                </div>
                <div class="status-box">
                    <span class="code">Exposed ENV Files</span>
                    <p>Zapomenuté soubory <code>.env</code> obsahující API klíče, hesla k DB a tajné klíče k šifrování (SECRET_KEY).</p>
                </div>
            </div>
        </section>

        <section class="content-section">
            <h2>HTTP Security Headers (Obranný val)</h2>
            <p>Chybějící bezpečnostní hlavičky jsou v BBP brány jako "Informational" nebo "Low" bugy, ale jejich absence často umožňuje eskalaci jiných útoků (např. Clickjacking nebo XSS).</p>
            <table>
                <thead>
                    <tr>
                        <th>Hlavička</th>
                        <th>Účel</th>
                        <th>Dopad absence</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Content-Security-Policy (CSP)</td><td>Omezuje zdroje, odkud lze nahrát skripty.</td><td>Snazší provedení XSS útoku.</td></tr>
                    <tr><td>X-Frame-Options</td><td>Zakazuje vkládání webu do iframe.</td><td>Možnost Clickjackingu.</td></tr>
                    <tr><td>Strict-Transport-Security</td><td>Vynucuje HTTPS komunikaci.</td><td>Možnost Man-in-the-Middle (MITM) útoků.</td></tr>
                    <tr><td>X-Content-Type-Options</td><td>Brání prohlížeči v "hádání" typu souboru.</td><td>MIME-sniffing útoky.</td></tr>
                </tbody>
            </table>
        </section>

        <section class="content-section">
            <h2>Recon v praxi: Directory Browsing</h2>
            <p>Pokud server vypíše obsah složky, je to pro útočníka mapa pokladu. Hledáme indexy jako <code>/backup/</code>, <code>/old/</code>, nebo <code>/.git/</code>.</p>
            
            <div class="terminal-window">
                <div class="terminal-header">recon_scanner — dirsearch</div>
                <div class="terminal-body">
                    <span class="prompt">$</span> dirsearch -u https://target.com -e php,txt,zip,bak<br>
                    <span class="output">[200] https://target.com/config.php.bak (Size: 2KB)</span><br>
                    <span class="output">[200] https://target.com/.env (Size: 1KB)</span><br>
                    <span class="output">[200] https://target.com/database.zip (Size: 150MB)</span><br>
                    <span class="prompt"># Kritický nález! Přístup k citlivým datům a konfiguraci.</span>
                </div>
            </div>
        </section>

        <section class="content-section">
            <h2>Prevence: IaC a Automatizovaný Hardening</h2>
            <p>Bezpečnostní konfigurace musí být definována kódem (Infrastructure as Code). Pokud se prostředí nasazuje ručně, chybuje se.</p>
            <div class="knowledge-box" style="border-color: #00ff41;">
                <ul>
                    <li><strong>Minimalismus:</strong> Odinstalujte vše, co není potřeba (principle of attack surface reduction).</li>
                    <li><strong>Security Audits:</strong> Pravidelné skenování pomocí nástrojů jako <code>Nikto</code> nebo <code>Nuclei</code> k odhalení starých verzí a špatných nastavení.</li>
                    <li><strong>Centralizovaný Error Handling:</strong> Vypněte debug režim a stack trace. Uživatel vidí jen kód chyby (Reference ID).</li>
                </ul>
            </div>
        </section>
    </main>

    <footer>
        <p>TERMINAL_LOG: ACCESS_CONTROL_FAILURE_DETECTED // STATUS: CRITICAL</p>
    </footer>
</body>
</html>