<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="../styles/sidestyle.css">
    <link rel="icon" type="image/png" href="../Images/icon.png">
    <title>Broken Access Control | OWASP #1 Analysis</title>
</head>
<body>
    <div class="overlay"></div>
    
    <header class="main-header">
        <a href="web_security.html" class="header-link">
            <h1>[ MISHANDLING_OF_EXCEPTIONAL_CONDITIONS ]</h1>
            <p>Kliknutím se vrátíš zpět.</p>
        </a>
    </header>

    <main class="detail-container">
        <section class="content-section">
            <h2>Když se plán "B" stane hrozbou</h2>
            <p><strong>Mishandling of Exceptional Conditions</strong> řeší situace, kdy aplikace opustí svou "šťastnou cestu" (happy path) a narazí na neočekávaný stav. V BBP hunteři záměrně vyvolávají chyby, aby získali citlivá data nebo obešli logiku aplikace v momentě, kdy je systém nestabilní.</p>
            
            <div class="knowledge-box">
                <h3>Kritické vektory selhání:</h3>
                <ul>
                    <li><strong>Information Leakage (Verbose Errors):</strong> Únik interních informací o infrastruktuře skrze chybové hlášky.</li>
                    <li><strong>Improper Error State (Fail-Open):</strong> Stav, kdy selhání bezpečnostní kontroly vyústí v povolení přístupu.</li>
                    <li><strong>Resource Exhaustion:</strong> Neošetřené výjimky, které za sebou neuklízejí (neuzavřené soubory, paměť), vedoucí k DoS.</li>
                </ul>
            </div>
        </section>

        

        <section class="content-section">
            <h2>Hloubková analýza: Stack Trace & Debug Info</h2>
            <p>Pro útočníka je <strong>Stack Trace</strong> (výpis zásobníku) mapou k pokladu. Prozrazuje nejen použité frameworky a jejich verze, ale i vnitřní logiku kódu a cesty v souborovém systému.</p>
            
            <div class="terminal-window">
                <div class="terminal-header">server_response — 500_internal_server_error</div>
                <div class="terminal-body">
                    <span class="error">Exception in thread "main" java.sql.SQLException: Access denied for user 'db_admin'@'10.0.0.5'</span><br>
                    <span class="output">&nbsp;&nbsp;at com.target.app.DBManager.connect(DBManager.java:42)</span><br>
                    <span class="output">&nbsp;&nbsp;at com.target.app.AuthService.validate(AuthService.java:115)</span><br>
                    <span class="prompt"># Hunter vidí: IP databáze, jméno DB uživatele a strukturu balíčků v Javě.</span>
                </div>
            </div>
        </section>

        <section class="content-section">
            <h2>Fail-Open: Nebezpečí "pohodlné" chyby</h2>
            <p>K <strong>Fail-Open</strong> dochází, když programátor předpokládá, že pokud se něco pokazí, není důvod uživatele obtěžovat. V bezpečnostních funkcích (autentizace, filtry) je to fatální.</p>
            <div class="grid">
                <div class="status-box">
                    <span class="code">Scénář: WAF Bypass</span>
                    <p>Pokud webový firewall (WAF) při extrémní zátěži přestane stíhat a prostě "pustí" všechen provoz bez kontroly (aby web nespadl), útočník může v tento moment poslat škodlivý payload.</p>
                </div>
                <div class="status-box">
                    <span class="code">Scénář: Auth Service Outage</span>
                    <p>Mikroslužba pro ověření práv je nedostupná. Aplikace místo chyby 403 vrátí 200 OK, protože "nemá instrukci k zamítnutí".</p>
                </div>
            </div>
        </section>

        

        <section class="content-section">
            <h2>Side-Channel útoky skrze chyby</h2>
            <p>I když aplikace nevrací detailní chybu, hunter může sledovat <strong>časovou odezvu</strong> (Time-based side channel). Pokud zpracování chyby u existujícího uživatele trvá 500 ms a u neexistujícího 10 ms, aplikace právě prozradila informaci o existenci uživatele (User Enumeration).</p>
        </section>

        <section class="content-section">
            <h2>Prevence: Resilience by Design</h2>
            <p>Zabezpečení výjimek vyžaduje disciplínu a centralizaci.</p>
            <table>
                <thead>
                    <tr>
                        <th>Opatření</th>
                        <th>Technický dopad</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Custom Error Pages</td><td>Uživatel vidí jen statické HTML (např. 404.html), žádný kód.</td></tr>
                    <tr><td>Global Exception Handler</td><td>Jediné místo v kódu, které zachytí všechny pády a bezpečně je zaloguje.</td></tr>
                    <tr><td>Automatic Resource Release</td><td>Použití konstrukcí jako <code>try-with-resources</code> k eliminaci DoS.</td></tr>
                    <tr><td>Fail-Closed Policy</td><td>Pokud nastane nejasný stav, operace se vždy přeruší a přístup zamítne.</td></tr>
                </tbody>
            </table>
        </section>

        <section class="content-section">
            <h2>Shrnutí OWASP (A10:2025)</h2>
            <div class="knowledge-box" style="border-color: #00ff41;">
                <p>Nová definice zdůrazňuje, že moderní systémy jsou <strong>distribuované</strong>. Selhání jedné komponenty nesmí vyvolat kaskádové selhání (Cascading Failure), které by odkrylo citlivá data v celém ekosystému. Rezilience (odolnost) je novým standardem bezpečnosti.</p>
            </div>
        </section>
    </main>

    <footer>
        <p>TERMINAL_LOG: ACCESS_CONTROL_FAILURE_DETECTED // STATUS: CRITICAL</p>
    </footer>
</body>
</html>