<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="../styles/sidestyle.css">
    <link rel="icon" type="image/png" href="../Images/icon.png">
    <title>Broken Access Control | OWASP #1 Analysis</title>
</head>
<body>
    <div class="overlay"></div>
    
    <header class="main-header">
        <a href="web_security.html" class="header-link">
            <h1>[ SOFTWARE_OR_DATA_INTEGRITY_FAILURES ]</h1>
            <p>Kliknutím se vrátíš zpět.</p>
        </a>
    </header>

    <main class="detail-container">
        <section class="content-section">
            <h2>Když slepá důvěra zabíjí</h2>
            <p><strong>Software and Data Integrity Failures</strong> se zaměřují na kód a infrastrukturu, které neověřují původ a integritu dat nebo softwaru. V BBP hunteři hledají mechanismy, kde aplikace přijímá "balíček" (update, knihovnu, serializovaný objekt) a věří mu jen proto, že přišel ze známé adresy.</p>
            
            <div class="knowledge-box">
                <h3>Klíčové vektory útoku:</h3>
                <ul>
                    <li><strong>Unsigned Updates:</strong> Firmware nebo software updaty stahované přes HTTP nebo bez validace digitálního podpisu.</li>
                    <li><strong>CI/CD Poisoning:</strong> Útok na build servery (Jenkins, GitHub Actions), kde útočník vloží "zadní vrátka" přímo do binárního souboru.</li>
                    <li><strong>Insecure Deserialization:</strong> Manipulace s objekty, které aplikace "rozbaluje" do paměti, vedoucí k okamžitému spuštění kódu (RCE).</li>
                </ul>
            </div>
        </section>

        

        <section class="content-section">
            <h2>Hloubková analýza: Subresource Integrity (SRI)</h2>
            <p>Moderní weby načítají JS knihovny z CDN (např. Cloudflare, Google). Pokud útočník kompromituje CDN, může změnit kód skriptu (CDN Poisoning). Obrana SRI (Subresource Integrity) zajišťuje, že prohlížeč spustí kód jen tehdy, pokud hash odpovídá očekávání.</p>
            
            <div class="terminal-window">
                <div class="terminal-header">browser_security — sri_check</div>
                <div class="terminal-body">
                    <span class="prompt"># HTML kód s SRI:</span><br>
                    <span class="output">&lt;script src="https://cdn.com/lib.js" <br> integrity="sha384-Li9vy3..." crossorigin="anonymous"&gt;&lt;/script&gt;</span><br>
                    <span class="prompt"># Pokud útočník změní lib.js:</span><br>
                    <span class="error">Console Error: Integrity check failed. Resource blocked.</span>
                </div>
            </div>
        </section>

        

        <section class="content-section">
            <h2>Nebezpečná Deserializace (Insecure Deserialization)</h2>
            <p>Tato zranitelnost je v BBP svatým grálem. Útočník upraví serializovaný objekt (např. v Java, PHP nebo Pythonu), který aplikace přijme jako vstup (např. v cookie). Při procesu <code>unserialize()</code> nebo <code>readObject()</code> interpret spustí destruktor nebo metodu, kterou útočník zneužije k ovládnutí systému.</p>
            <div class="grid">
                <div class="status-box">
                    <span class="code">PHP Object Injection</span>
                    <p>Zneužití magických metod (<code>__wakeup</code>, <code>__destruct</code>) k smazání souborů nebo RCE.</p>
                </div>
                <div class="status-box">
                    <span class="code">Java Deserialization</span>
                    <p>Použití "gadget chains" (řetězců existujících tříd) k vykonání libovolného kódu na serveru.</p>
                </div>
            </div>
        </section>

        <section class="content-section">
            <h2>Prevence: Model "Verify First"</h2>
            <p>Obrana vyžaduje přísnou kontrolu nad každým bitem kódu, který do systému vstupuje.</p>
            <table>
                <thead>
                    <tr>
                        <th>Nástroj / Technika</th>
                        <th>Účel</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Digital Signatures (GPG/CodeSign)</td><td>Ověření, že kód nebyl cestou od autora změněn.</td></tr>
                    <tr><td>Software Bill of Materials (SBOM)</td><td>Detailní inventář všech knihoven a jejich verzí pro rychlou reakci na CVE.</td></tr>
                    <tr><td>Integrity Hashes (SHA-256)</td><td>Kontrola, zda stažený soubor odpovídá originálu bajt po bajtu.</td></tr>
                    <tr><td>Safe Deserialization</td><td>Používání čistého JSON/XML s validací schématu místo nativních objektů.</td></tr>
                </tbody>
            </table>
        </section>

        <section class="content-section">
            <h2>Dopady v reálném světě</h2>
            <div class="knowledge-box" style="border-color: #ff0041;">
                <p><strong>SolarWinds (2020):</strong> Útočníci nehackli tisíce firem. Hackli jeden build server SolarWinds a vložili malware do oficiálního updatu. Výsledek? 18 000 kompromitovaných organizací jedinou aktualizací. To je síla selhání integrity.</p>
            </div>
        </section>
    </main>

    <footer>
        <p>TERMINAL_LOG: ACCESS_CONTROL_FAILURE_DETECTED // STATUS: CRITICAL</p>
    </footer>
</body>
</html>